function [Lf, Lfx, Lfxx] = autoLf(x, i, param, xf, p, k)
x1 = x(1);
x2 = x(2);
x3 = x(3);
x4 = x(4);
xf1 = xf(1);
xf2 = xf(2);
xf3 = xf(3);
xf4 = xf(4);
p1 = p(1);
p2 = p(2);
p3 = p(3);
p4 = p(4);
k1 = k(1);
k2 = k(2);
k3 = k(3);
k4 = k(4);
Lf = [(- k1*(p1 - ((x1 - xf1)^2 + p1^2)^(1/2)) - k2*(p2 - ((x2 - xf2)^2 + p2^2)^(1/2)) - k3*(p3 - ((x3 - xf3)^2 + p3^2)^(1/2)) - k4*(p4 - ((x4 - xf4)^2 + p4^2)^(1/2)))];
Lfx = [((k1*(2*x1 - 2*xf1))/(2*((x1 - xf1)^2 + p1^2)^(1/2))); ((k2*(2*x2 - 2*xf2))/(2*((x2 - xf2)^2 + p2^2)^(1/2))); ((k3*(2*x3 - 2*xf3))/(2*((x3 - xf3)^2 + p3^2)^(1/2))); ((k4*(2*x4 - 2*xf4))/(2*((x4 - xf4)^2 + p4^2)^(1/2)))];
Lfxx = [(k1/((x1 - xf1)^2 + p1^2)^(1/2) - (k1*(2*x1 - 2*xf1)^2)/(4*((x1 - xf1)^2 + p1^2)^(3/2))) (0) (0) (0); (0) (k2/((x2 - xf2)^2 + p2^2)^(1/2) - (k2*(2*x2 - 2*xf2)^2)/(4*((x2 - xf2)^2 + p2^2)^(3/2))) (0) (0); (0) (0) (k3/((x3 - xf3)^2 + p3^2)^(1/2) - (k3*(2*x3 - 2*xf3)^2)/(4*((x3 - xf3)^2 + p3^2)^(3/2))) (0); (0) (0) (0) (k4/((x4 - xf4)^2 + p4^2)^(1/2) - (k4*(2*x4 - 2*xf4)^2)/(4*((x4 - xf4)^2 + p4^2)^(3/2)))];
end
